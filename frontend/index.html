<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Loyalty Wallet</title>
    <link rel="stylesheet" href="styles/main.css">
    <link rel="stylesheet" href="styles/card-view.css">
    <link rel="stylesheet" href="styles/add-card-menu.css">
    <link rel="stylesheet" href="styles/add-card.css">
</head>
<body>
<div style="position:fixed;bottom:0;right:0;z-index:9999;background:black;color:white;padding:4px">
    INDEX v2026-01-05
</div>

<main>

    <!-- Экран: список карт -->
    <section id="view-list" class="view">

        <!-- Header -->
        <div class="header">
            <h1>Мои карты</h1>
            <button id="add-card-btn" class="add-btn">+</button>
        </div>

        <!-- Закреплено -->
        <div class="sticky-filters">
            <!-- Поиск -->
            <div class="search-wrapper">
                <input
                    id="search-input"
                    class="search-input"
                    type="text"
                    placeholder="Поиск"
                />
                <button id="clear-search" class="clear-search hidden" aria-label="Очистить поиск"></button>

            </div>
            <!-- Категории -->
            <div id="category-tabs" class="category-tabs">
                <button data-category="favorites">
                    <svg xmlns="http://www.w3.org/2000/svg"
                        viewBox="0 -960 960 960"
                        fill="currentColor">
                        <path d="m354-287 126-76 126 77-33-144 111-96-146-13-58-136-58 135-146 13 111 97-33 143ZM233-120l65-281L80-590l288-25 112-265 112 265 288 25-218 189 65 281-247-149-247 149Zm247-350Z"/>
                    </svg>
                </button>
                <button data-category="all" class="active">Все</button>
                <button data-category="groceries">Продукты</button>
                <button data-category="cafe">Кафе</button>
                <button data-category="clothes">Одежда</button>
                <button data-category="pharmacy">Аптеки</button>
            </div>

        </div>

        <!-- Инфо строка -->
        <div class="list-info">
            <span id="cards-count">0 карт</span>

            <div class="view-modes">
                <button id="sort-button" class="icon-btn ghost" aria-label="Сортировка">
                    <svg xmlns="http://www.w3.org/2000/svg"
                        height="22px"
                        viewBox="0 -960 960 960"
                        width="22px"
                        fill="#c3c3c8">
                        <path d="M120-240v-80h240v80H120Zm0-200v-80h480v80H120Zm0-200v-80h720v80H120Z"/>
                    </svg>
                </button>
                <button id="view-toggle" aria-label="Переключить вид"></button>
            </div>
        </div>

        <!-- Карты -->
        <div id="cards-grid" class="cards-grid"></div>

    </section>


    <!-- Экран: добавление карты -->
    <section id="view-add" class="view hidden">

        <!-- Header -->
        <div class="header">
            <button class="icon-btn" data-back="list" aria-label="Назад">
                <svg class="icon" viewBox="0 0 24 24">
                    <path d="M15.41 7.41 14 6l-6 6 6 6 1.41-1.41L10.83 12z"/>
                </svg>
            </button>

            <h1>Добавить карту</h1>

            <button
                id="save-card-btn"
                class="icon-btn save-btn disabled"
                aria-label="Добавить"
                disabled
            >
                <svg
                    xmlns="http://www.w3.org/2000/svg"
                    height="24px"
                    viewBox="0 -960 960 960"
                    width="24px"
                    class="save-icon"
                >
                    <path d="M382-240 154-468l57-57 171 171 367-367 57 57-424 424Z"/>
                </svg>
            </button>

        </div>

        <!-- Контент -->
        <div class="add-card-content">

            <!-- Предпросмотр кода -->
            <div id="add-card-preview" class="card-preview gray">
                <div id="add-card-code-preview"></div>
            </div>

            <!-- Форма -->
            <div class="add-card-form">

                <!-- Название -->
                <div class="input-card">
                    <input
                        id="add-card-title"
                        type="text"
                        placeholder="Название карты"
                    />
                </div>

                <!-- Категория -->
                <div class="input-card">
                    <select id="add-card-category">
                        <option value="other">Категория: Другое</option>
                        <option value="groceries">Продукты</option>
                        <option value="cafe">Кафе</option>
                        <option value="clothes">Одежда</option>
                        <option value="pharmacy">Аптеки</option>
                        <option value="electronics">Электроника</option>
                    </select>
                </div>

                <!-- Тип кода -->
                <div class="input-card">
                    <select id="add-card-code-type">
                        <option value="auto">Тип кода: Авто</option>
                        <option value="qr">QR</option>
                        <option value="ean13">EAN-13</option>
                        <option value="ean8">EAN-8</option>
                        <option value="code128">Code 128</option>
                        <option value="upc">UPC</option>
                    </select>
                </div>

                <!-- Код -->
                <div class="input-card">
                    <input
                        id="add-card-code-value"
                        type="text"
                        placeholder="Введите или отсканируйте код"
                    />
                </div>

                <!-- Цвет (ручной выбор, опционально) -->
                <div class="section-title">Цвет карты</div>
                <div class="color-grid">
                    <button class="color-swatch red"    data-color="red"></button>
                    <button class="color-swatch green"  data-color="green"></button>
                    <button class="color-swatch blue"   data-color="blue"></button>
                    <button class="color-swatch orange" data-color="orange"></button>
                    <button class="color-swatch purple" data-color="purple"></button>
                    <button class="color-swatch teal"   data-color="teal"></button>
                    <button class="color-swatch brown"  data-color="brown"></button>
                    <button class="color-swatch gray"   data-color="gray"></button>
                </div>

            </div>
        </div>

    </section>




    <!-- Экран: просмотр карты -->
    <section id="view-card" class="view hidden">
        <div class="card-view-header">
            <button class="icon-btn" data-back="list" aria-label="Назад">
                <svg class="icon"
                    xmlns="http://www.w3.org/2000/svg"
                    viewBox="0 0 24 24">
                    <path d="M15.41 7.41 14 6l-6 6 6 6 1.41-1.41L10.83 12z"/>
                </svg>
            </button>
            <span class="card-view-title">Карта</span>
            <button class="icon-btn ghost" id="open-sheet" aria-label="Меню">
                <svg class="icon"
                    xmlns="http://www.w3.org/2000/svg"
                    viewBox="0 0 24 24">
                    <path d="M12 8a2 2 0 1 0-.001-3.999A2 2 0 0 0 12 8zm0 6a2 2 0 1 0-.001-3.999A2 2 0 0 0 12 14zm0 6a2 2 0 1 0-.001-3.999A2 2 0 0 0 12 20z"/>
                </svg>
            </button>
        </div>

        <div class="card-view-content">
            <div id="card-preview"></div>
        </div>
    </section>
</main>

<!-- Bottom sheet -->
<div id="sheet-backdrop" class="sheet-backdrop hidden"></div>

<div id="card-sheet" class="card-sheet hidden">
    <div class="sheet-handle"></div>

    <div class="sheet-actions">
        <button class="sheet-action primary" data-action="fullscreen">
            <svg class="icon">
                <use href="#icon-fullscreen"></use>
            </svg>
            <span>Полный экран</span>
        </button>

        <button class="sheet-action danger" data-action="delete">
            <svg class="icon">
                <use href="#icon-delete"></use>
            </svg>
            <span>Удалить</span>
        </button>

        <button id="favorite-action" class="sheet-action secondary" data-action="favorite">
            <svg xmlns="http://www.w3.org/2000/svg"
                height="24px"
                viewBox="0 -960 960 960"
                width="24px"
                fill="currentColor">
                <path d="m354-287 126-76 126 77-33-144 111-96-146-13-58-136-58 135-146 13 111 97-33 143ZM233-120l65-281L80-590l288-25 112-265 112 265 288 25-218 189 65 281-247-149-247 149Zm247-350Z"/>
            </svg>
            <span>Избранное</span>
        </button>
    </div>
</div>

<div id="color-sheet" class="card-sheet hidden">
    <div class="sheet-handle"></div>

    <div class="color-grid">
        <button class="color-swatch red"    data-color="red"></button>
        <button class="color-swatch green"  data-color="green"></button>
        <button class="color-swatch blue"   data-color="blue"></button>
        <button class="color-swatch orange" data-color="orange"></button>
        <button class="color-swatch purple" data-color="purple"></button>
        <button class="color-swatch teal"   data-color="teal"></button>
        <button class="color-swatch brown"  data-color="brown"></button>
        <button class="color-swatch gray"   data-color="gray"></button>
    </div>
</div>

<div id="sort-sheet" class="card-sheet hidden add-card-menu">
    <div class="sheet-handle"></div>

    <div class="sheet-actions">
        <button class="sheet-action secondary" data-sort="date">
            <span>По дате добавления</span>
        </button>

        <button class="sheet-action secondary" data-sort="name">
            <span>По алфавиту</span>
        </button>

        <button class="sheet-action secondary" data-sort="color">
            <span>По цвету</span>
        </button>
    </div>
</div>

<svg style="display:none">
    <symbol id="icon-delete" viewBox="0 0 24 24">
        <path d="M6 19q0 .825.588 1.413Q7.175 21 8 21h8q.825 0 1.413-.587Q18 19.825 18 19V7H6Zm13-15h-3.5l-1-1h-5l-1 1H5v2h14Z"/>
    </symbol>

    <symbol id="icon-fullscreen" viewBox="0 0 24 24">
        <path d="M7 21q-.825 0-1.412-.587Q5 19.825 5 19V5q0-.825.588-1.412Q6.175 3 7 3h10q.825 0 1.413.588Q19 4.175 19 5v14q0 .825-.587 1.413Q17.825 21 17 21Zm0-2h10V5H7v14Z"/>
    </symbol>
    <symbol id="icon-edit" viewBox="0 0 24 24">
        <path d="M3 17.25V21h3.75L17.81 9.94l-3.75-3.75L3 17.25Zm18-11.5a1 1 0 0 0 0-1.41l-2.34-2.34a1 1 0 0 0-1.41 0l-1.83 1.83 3.75 3.75L21 5.75Z"/>
    </symbol>
    <symbol id="icon-camera" viewBox="0 -960 960 960">
        <path d="M480-260q75 0 127.5-52.5T660-440q0-75-52.5-127.5T480-620q-75 0-127.5 52.5T300-440q0 75 52.5 127.5T480-260Zm0-80q-42 0-71-29t-29-71q0-42 29-71t71-29q42 0 71 29t29 71q0 42-29 71t-71 29ZM160-120q-33 0-56.5-23.5T80-200v-480q0-33 23.5-56.5T160-760h126l74-80h240l74 80h126q33 0 56.5 23.5T880-680v480q0 33-23.5 56.5T800-120H160Zm0-80h640v-480H638l-73-80H395l-73 80H160v480Zm320-240Z"/>
    </symbol>
</svg>

<!-- Fullscreen card -->
<div id="fullscreen-card" class="fullscreen-card hidden">
    <div class="fullscreen-content" id="fullscreen-content"></div>
</div>

<script src="https://telegram.org/js/telegram-web-app.js"></script>
<script src="https://cdn.jsdelivr.net/npm/qrcodejs@1.0.0/qrcode.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/jsbarcode@3.11.5/dist/JsBarcode.all.min.js"></script>
<script type="module" src="scripts/app.js"></script>
</body>
</html>


